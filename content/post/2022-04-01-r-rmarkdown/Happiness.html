---
title: "Structural Parameters of World Happiness ladder"
author:
  - name: Job Nmadu
    url: https://jobnmadu.rbind.io/
date: '2022-03-13'
output:
  prettydoc::html_pretty:
    theme: cayman #tactile, architect, leonids, hpstr
    highlight: vignette #github
    math: katex #latex
  html_document: default
  word_document: default
  pdf_document: 
    latex_engine: xelatex
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-1-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>source(&quot;docs/pca_summary.R&quot;)
source(&quot;docs/printloadings.R&quot;)

ll &lt;- factoring(Data = Data[, -c(1, 2, 12)], exclude = 0)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  NA </code></pre>
<pre class="r"><code>printLoadings(ll$Extrated_factors$loadings)</code></pre>
<pre><code>
Loadings:
           MR1    MR3    MR2    MR4   
Life_Exp    0.937                     
Freedom     0.754                     
Corruption  0.742                     
Generosity -0.510                0.465
GDP         0.427  0.853              
Year              -0.934              
Happiness                 0.906       
Support                   0.596       
Regional                         0.583

                 MR1   MR3   MR2   MR4
SS loadings    2.605 1.762 1.396 0.643
Proportion Var 0.289 0.196 0.155 0.071
Cumulative Var 0.289 0.485 0.640 0.712</code></pre>
<pre class="r"><code>fa.diagram(ll$Extrated_factors)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-2-2.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>kableExtra::kable_styling(knitr::kable(ll$Parameters_of_Extracted_factos, digits = 2), &quot;striped&quot;, position = &quot;center&quot;, font_size = 12)</code></pre>
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
degree of freedom
</td>
<td style="text-align:right;">
6.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Chi-sq
</td>
<td style="text-align:right;">
21.56
</td>
</tr>
<tr>
<td style="text-align:left;">
Chi-sq/df
</td>
<td style="text-align:right;">
3.59
</td>
</tr>
<tr>
<td style="text-align:left;">
Harmonic sample size
</td>
<td style="text-align:right;">
2368.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Root Mean Square
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
Probability of the empirical chi-sq
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Adjusted Root Mean Square
</td>
<td style="text-align:right;">
0.03
</td>
</tr>
<tr>
<td style="text-align:left;">
Empirical BIC
</td>
<td style="text-align:right;">
-25.06
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample size adjusted BIC
</td>
<td style="text-align:right;">
-6.00
</td>
</tr>
<tr>
<td style="text-align:left;">
fit (SSresidual vs SSoriginal values)
</td>
<td style="text-align:right;">
0.94
</td>
</tr>
<tr>
<td style="text-align:left;">
fit applied to off diagonal elements
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
SD of the residuals
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of factors extracted
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of observations
</td>
<td style="text-align:right;">
2368.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Value of the minimised function
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq based on the objective function
</td>
<td style="text-align:right;">
215.33
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value of observing the chi-sq
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq based on the objective function/df
</td>
<td style="text-align:right;">
5.98
</td>
</tr>
<tr>
<td style="text-align:left;">
Null model
</td>
<td style="text-align:right;">
5.22
</td>
</tr>
<tr>
<td style="text-align:left;">
df for null model
</td>
<td style="text-align:right;">
36.00
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq for null model
</td>
<td style="text-align:right;">
12331.50
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq for null model/df
</td>
<td style="text-align:right;">
342.54
</td>
</tr>
<tr>
<td style="text-align:left;">
Tucker Lewis Index of factoring reliability
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation
</td>
<td style="text-align:right;">
0.12
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-lower
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-upper
</td>
<td style="text-align:right;">
0.14
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-confidence interval
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-BIC
</td>
<td style="text-align:right;">
168.71
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-empirical BIC
</td>
<td style="text-align:right;">
187.77
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean item complexity
</td>
<td style="text-align:right;">
1.47
</td>
</tr>
<tr>
<td style="text-align:left;">
Kaiser Meyer Olkin Measure of Sampling Adequacy
</td>
<td style="text-align:right;">
0.66
</td>
</tr>
<tr>
<td style="text-align:left;">
Bartlett Chi
</td>
<td style="text-align:right;">
12331.50
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett p-value
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett df
</td>
<td style="text-align:right;">
36.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett Chi/df
</td>
<td style="text-align:right;">
342.54
</td>
</tr>
</tbody>
</table>
<pre class="r"><code># load libraries
library(lavaan)
library(semPlot)
library(semTools)
library(nonnest2)
library(htmlTable)

# constructing the measurement model
mea_model &lt;- &quot;MR1 =~ Life_Exp + Corruption + Freedom + Generosity
+ Year
              MR2 =~ Happiness + Support + GDP
              MR4 =~ Regional&quot;

# fitting the measurement model
mea_fit &lt;- sem(mea_model,
  data = Data
)

# summary statistics of the measurement model
summary(mea_fit,
  fit.measures = TRUE
)</code></pre>
<pre><code>lavaan 0.6-11 ended normally after 325 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        20
                                                      
  Number of observations                          2368
                                                      
Model Test User Model:
                                                      
  Test statistic                              5901.217
  Degrees of freedom                                25
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             12356.726
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.523
  Tucker-Lewis Index (TLI)                       0.313

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -31830.657
  Loglikelihood unrestricted model (H1)     -28880.048
                                                      
  Akaike (AIC)                               63701.314
  Bayesian (BIC)                             63816.710
  Sample-size adjusted Bayesian (BIC)        63753.165

Root Mean Square Error of Approximation:

  RMSEA                                          0.315
  90 Percent confidence interval - lower         0.308
  90 Percent confidence interval - upper         0.322
  P-value RMSEA &lt;= 0.05                          0.000

Standardized Root Mean Square Residual:

  SRMR                                           0.162

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  MR1 =~                                              
    Life_Exp          1.000                           
    Corruption        0.009    0.000   50.931    0.000
    Freedom           0.005    0.000   42.751    0.000
    Generosity       -0.003    0.000  -31.102    0.000
    Year             -0.051    0.003  -16.095    0.000
  MR2 =~                                              
    Happiness         1.000                           
    Support          -0.369    0.028  -13.168    0.000
    GDP               7.611    0.559   13.626    0.000
  MR4 =~                                              
    Regional          1.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  MR1 ~~                                              
    MR2               9.481    0.665   14.256    0.000
    MR4              -4.121    2.001   -2.060    0.039
  MR2 ~~                                              
    MR4              -0.029    0.028   -1.030    0.303

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Life_Exp         14.831    7.979    1.859    0.063
   .Corruption        0.049    0.002   31.473    0.000
   .Freedom           0.025    0.001   32.940    0.000
   .Generosity        0.022    0.001   33.929    0.000
   .Year             20.471    0.596   34.334    0.000
   .Happiness         1.212    0.035   34.481    0.000
   .Support           0.060    0.002   32.232    0.000
   .GDP              16.332    0.556   29.367    0.000
   .Regional          0.000                           
    MR1             905.615   27.908   32.450    0.000
    MR2               0.034    0.008    4.190    0.000
    MR4              10.287    0.299   34.409    0.000</code></pre>
<pre class="r"><code># 2.3 Obtain goodness of fit indicators of the model

kableExtra::kable_styling(knitr::kable(fitMeasures(mea_fit), rsqaure = TRUE), &quot;striped&quot;, position = &quot;center&quot;, font_size = 12)</code></pre>
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
npar
</td>
<td style="text-align:right;">
2.000000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
fmin
</td>
<td style="text-align:right;">
1.246034e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
chisq
</td>
<td style="text-align:right;">
5.901217e+03
</td>
</tr>
<tr>
<td style="text-align:left;">
df
</td>
<td style="text-align:right;">
2.500000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.chisq
</td>
<td style="text-align:right;">
1.235673e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.df
</td>
<td style="text-align:right;">
3.600000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
cfi
</td>
<td style="text-align:right;">
5.230625e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
tli
</td>
<td style="text-align:right;">
3.132099e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
nnfi
</td>
<td style="text-align:right;">
3.132099e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rfi
</td>
<td style="text-align:right;">
3.122974e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
nfi
</td>
<td style="text-align:right;">
5.224288e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
pnfi
</td>
<td style="text-align:right;">
3.627978e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
ifi
</td>
<td style="text-align:right;">
5.234879e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rni
</td>
<td style="text-align:right;">
5.230625e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
logl
</td>
<td style="text-align:right;">
-3.183066e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
unrestricted.logl
</td>
<td style="text-align:right;">
-2.888005e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
aic
</td>
<td style="text-align:right;">
6.370131e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
bic
</td>
<td style="text-align:right;">
6.381671e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
ntotal
</td>
<td style="text-align:right;">
2.368000e+03
</td>
</tr>
<tr>
<td style="text-align:left;">
bic2
</td>
<td style="text-align:right;">
6.375317e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea
</td>
<td style="text-align:right;">
3.150562e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.ci.lower
</td>
<td style="text-align:right;">
3.083157e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.ci.upper
</td>
<td style="text-align:right;">
3.218501e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
rmr
</td>
<td style="text-align:right;">
2.547464e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
rmr_nomean
</td>
<td style="text-align:right;">
2.547464e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr
</td>
<td style="text-align:right;">
1.617903e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_bentler
</td>
<td style="text-align:right;">
1.617903e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_bentler_nomean
</td>
<td style="text-align:right;">
1.617903e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
crmr
</td>
<td style="text-align:right;">
1.808870e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
crmr_nomean
</td>
<td style="text-align:right;">
1.808870e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_mplus
</td>
<td style="text-align:right;">
1.617903e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_mplus_nomean
</td>
<td style="text-align:right;">
1.617903e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
cn_05
</td>
<td style="text-align:right;">
1.610893e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
cn_01
</td>
<td style="text-align:right;">
1.878206e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
gfi
</td>
<td style="text-align:right;">
7.150677e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
agfi
</td>
<td style="text-align:right;">
4.871218e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
pgfi
</td>
<td style="text-align:right;">
3.972598e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
mfi
</td>
<td style="text-align:right;">
2.891657e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
ecvi
</td>
<td style="text-align:right;">
2.508960e+00
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>kableExtra::kable_styling(knitr::kable(reliability(mea_fit)), &quot;striped&quot;, position = &quot;center&quot;, font_size = 12)</code></pre>
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
MR1
</th>
<th style="text-align:right;">
MR2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
-0.1008247
</td>
<td style="text-align:right;">
0.0776043
</td>
</tr>
<tr>
<td style="text-align:left;">
omega
</td>
<td style="text-align:right;">
0.9592963
</td>
<td style="text-align:right;">
0.1152488
</td>
</tr>
<tr>
<td style="text-align:left;">
omega2
</td>
<td style="text-align:right;">
0.9592963
</td>
<td style="text-align:right;">
0.1152488
</td>
</tr>
<tr>
<td style="text-align:left;">
omega3
</td>
<td style="text-align:right;">
0.9556225
</td>
<td style="text-align:right;">
0.1109545
</td>
</tr>
<tr>
<td style="text-align:left;">
avevar
</td>
<td style="text-align:right;">
0.9624787
</td>
<td style="text-align:right;">
0.1017432
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>semPaths(mea_fit, &quot;par&quot;,
  edge.label.cex = 1.2,
  fade = FALSE,
  edge.label.postition = 1,
  edge.label.font = 70,
  edge.label.by = TRUE,
  layout = &quot;tree&quot;,
  sizeMan = 10
)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-2-3.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>semPaths(mea_fit,
  what = &quot;eq&quot;, whatLabels = &quot;est&quot;, style = &quot;lisrel&quot;,
  layout = &quot;tree2&quot;, rotation = 1, color = list(
    lat = rgb(255, 200, 135, maxColorValue = 255),
    man = rgb(155, 240, 175, maxColorValue = 255)
  )
)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-2-4.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Happy, data = Data, index = c(&quot;Country&quot;, &quot;Year&quot;))

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-1.319433 -0.194675 -0.005154  0.191480  1.465874 

Coefficients:
              Estimate  Std. Error t-value  Pr(&gt;|t|)    
Life_Exp    0.00244629  0.00070537  3.4681 0.0005343 ***
Corruption -0.17859111  0.04151551 -4.3018 1.769e-05 ***
Freedom     0.57528099  0.07276521  7.9060 4.176e-15 ***
Generosity  0.33316883  0.10337442  3.2229 0.0012875 ** 
Support     0.26725906  0.05270122  5.0712 4.285e-07 ***
GDP        -0.00736100  0.00231426 -3.1807 0.0014897 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    288.3
Residual Sum of Squares: 268.59
R-Squared:      0.068377
Adj. R-Squared: -0.0069186
F-statistic: 26.7894 on 6 and 2190 DF, p-value: &lt; 2.22e-16</code></pre>
<pre><code>Oneway (time) effect Random Effect Model 
   (Amemiya&#39;s transformation)

Call:
plm(formula = Happy, data = Data, effect = &quot;time&quot;, model = &quot;random&quot;, 
    random.method = &quot;amemiya&quot;, index = c(&quot;Country&quot;, &quot;Year&quot;))

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Effects:
                 var std.dev share
idiosyncratic 0.4675  0.6837 0.194
time          1.9398  1.3928 0.806
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.9059  0.9581  0.9598  0.9577  0.9607  0.9610 

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-2.1627 -0.4236  0.0042  0.0042  0.4355  3.7833 

Coefficients:
              Estimate Std. Error z-value  Pr(&gt;|z|)    
(Intercept)  0.4549410  0.3459834  1.3149    0.1885    
Life_Exp     0.0111283  0.0018473  6.0242 1.700e-09 ***
Corruption  -0.6852797  0.0736435 -9.3054 &lt; 2.2e-16 ***
Freedom      1.4847512  0.1017427 14.5932 &lt; 2.2e-16 ***
Generosity   0.6025953  0.1014934  5.9373 2.898e-09 ***
Support      2.3813023  0.0803767 29.6268 &lt; 2.2e-16 ***
GDP          0.3237753  0.0170784 18.9582 &lt; 2.2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    2916.2
Residual Sum of Squares: 1103.2
R-Squared:      0.62173
Adj. R-Squared: 0.62077
Chisq: 3871.08 on 6 DF, p-value: &lt; 2.22e-16</code></pre>
<pre><code>
    Hausman Test

data:  Happy
chisq = 610.5, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre><code>
    Hausman Test

data:  Happy
chisq = 610.5, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre><code>
    Hausman Test

data:  Happy
chisq = 303.63, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre><code>
    Regression-based Hausman test

data:  Happy
chisq = 611.71, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre><code>
    Regression-based Hausman test, vcov: vcovHC

data:  Happy
chisq = 375.38, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre><code>
    Regression-based Hausman test, vcov: function(x) vcovHC(x, method =
    &quot;white2&quot;, type = &quot;HC3&quot;)

data:  Happy
chisq = 486.7, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre class="r"><code>coplot(Happiness ~ Year | Region1, type = &quot;b&quot;, data = dataPanel1)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>scatterplot(Happiness ~ Year | Country, type = &quot;b&quot;, data = dataPanel)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-4-2.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>[1] &quot;14&quot; &quot;15&quot;</code></pre>
<pre class="r"><code>plotmeans(Happiness ~ Year, data = dataPanel)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-4-3.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ols &lt;- lm(Happy, data = dataPanel)
summary(ols)</code></pre>
<pre><code>
Call:
lm(formula = Happy, data = dataPanel)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7455 -0.5116  0.0105  0.5312  3.2729 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.024070   0.087206  23.210  &lt; 2e-16 ***
Life_Exp     0.016473   0.001195  13.782  &lt; 2e-16 ***
Corruption  -1.103248   0.074806 -14.748  &lt; 2e-16 ***
Freedom      1.481329   0.110429  13.414  &lt; 2e-16 ***
Generosity   0.855013   0.113988   7.501 8.92e-14 ***
Support      2.411561   0.074784  32.247  &lt; 2e-16 ***
GDP          0.031719   0.004917   6.451 1.34e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7869 on 2361 degrees of freedom
Multiple R-squared:  0.5045,    Adjusted R-squared:  0.5033 
F-statistic: 400.7 on 6 and 2361 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fixed.dum &lt;- lm(Happiness ~ Life_Exp + Corruption + Freedom + Generosity +
  Support + GDP + factor(Country) - 1, data = dataPanel)
summary(fixed.dum)</code></pre>
<pre><code>
Call:
lm(formula = Happiness ~ Life_Exp + Corruption + Freedom + Generosity + 
    Support + GDP + factor(Country) - 1, data = dataPanel)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.31943 -0.19468 -0.00515  0.19148  1.46587 

Coefficients:
                                          Estimate Std. Error t value Pr(&gt;|t|)
Life_Exp                                 0.0024463  0.0007054   3.468 0.000534
Corruption                              -0.1785911  0.0415155  -4.302 1.77e-05
Freedom                                  0.5752810  0.0727652   7.906 4.18e-15
Generosity                               0.3331688  0.1033744   3.223 0.001287
Support                                  0.2672591  0.0527012   5.071 4.28e-07
GDP                                     -0.0073610  0.0023143  -3.181 0.001490
factor(Country)Afghanistan               3.1416594  0.1019733  30.809  &lt; 2e-16
factor(Country)Albania                   4.5040176  0.1065582  42.268  &lt; 2e-16
factor(Country)Algeria                   5.0868173  0.1155421  44.026  &lt; 2e-16
factor(Country)Angola                    3.8343934  0.1349185  28.420  &lt; 2e-16
factor(Country)Argentina                 5.7457263  0.1104156  52.037  &lt; 2e-16
factor(Country)Armenia                   4.1192198  0.1006515  40.926  &lt; 2e-16
factor(Country)Australia                 6.4103457  0.1282878  49.968  &lt; 2e-16
factor(Country)Austria                   6.4267910  0.1247563  51.515  &lt; 2e-16
factor(Country)Azerbaijan                4.4984563  0.1035573  43.439  &lt; 2e-16
factor(Country)Bahrain                   5.3661401  0.1180398  45.460  &lt; 2e-16
factor(Country)Bangladesh                4.2260262  0.1008736  41.894  &lt; 2e-16
factor(Country)Belarus                   5.0515192  0.1087213  46.463  &lt; 2e-16
factor(Country)Belgium                   6.2599859  0.1171718  53.426  &lt; 2e-16
factor(Country)Belize                    5.4297039  0.1703472  31.874  &lt; 2e-16
factor(Country)Benin                     3.5319650  0.1041599  33.909  &lt; 2e-16
factor(Country)Bhutan                    4.4335169  0.1575293  28.144  &lt; 2e-16
factor(Country)Bolivia                   5.1233177  0.1087712  47.102  &lt; 2e-16
factor(Country)Bosnia and Herzegovina    4.7465664  0.1117225  42.485  &lt; 2e-16
factor(Country)Botswana                  3.4163792  0.1111559  30.735  &lt; 2e-16
factor(Country)Brazil                    6.0364019  0.1115462  54.116  &lt; 2e-16
factor(Country)Bulgaria                  3.9804707  0.1152761  34.530  &lt; 2e-16
factor(Country)Burkina Faso              3.6287509  0.1050372  34.547  &lt; 2e-16
factor(Country)Burundi                   3.0821294  0.1080597  28.522  &lt; 2e-16
factor(Country)Cambodia                  3.5209915  0.1126859  31.246  &lt; 2e-16
factor(Country)Cameroon                  4.0492081  0.1038831  38.979  &lt; 2e-16
factor(Country)Canada                    6.5274223  0.1237770  52.735  &lt; 2e-16
factor(Country)Central African Republic  3.0791522  0.1299953  23.687  &lt; 2e-16
factor(Country)Chad                      3.6319145  0.0998438  36.376  &lt; 2e-16
factor(Country)Chile                     5.7619477  0.1135302  50.753  &lt; 2e-16
factor(Country)China                     4.4545503  0.1061024  41.984  &lt; 2e-16
factor(Country)Colombia                  5.6362079  0.1115057  50.546  &lt; 2e-16
factor(Country)Comoros                   3.5684403  0.1226953  29.084  &lt; 2e-16
factor(Country)Congo (Brazzaville)       3.9743142  0.1097841  36.201  &lt; 2e-16
factor(Country)Congo (Kinshasa)          3.8931293  0.1218946  31.938  &lt; 2e-16
factor(Country)Costa Rica                6.4391185  0.1157616  55.624  &lt; 2e-16
factor(Country)Croatia                   5.1381406  0.1089109  47.177  &lt; 2e-16
factor(Country)Cuba                      4.8296810  0.3590271  13.452  &lt; 2e-16
factor(Country)Cyprus                    5.4313239  0.1147290  47.340  &lt; 2e-16
factor(Country)Czech Republic            5.9887319  0.1156075  51.802  &lt; 2e-16
factor(Country)Denmark                   6.7836540  0.1241897  54.623  &lt; 2e-16
factor(Country)Djibouti                  4.2122016  0.1659793  25.378  &lt; 2e-16
factor(Country)Dominican Republic        4.5235636  0.1122609  40.295  &lt; 2e-16
factor(Country)Ecuador                   5.1906231  0.1078654  48.121  &lt; 2e-16
factor(Country)Egypt                     4.0671335  0.1008465  40.330  &lt; 2e-16
factor(Country)El Salvador               5.4204954  0.1056732  51.295  &lt; 2e-16
factor(Country)Estonia                   4.9901109  0.1128115  44.234  &lt; 2e-16
factor(Country)Ethiopia                  3.8321912  0.1208343  31.714  &lt; 2e-16
factor(Country)Finland                   6.7488924  0.1230982  54.825  &lt; 2e-16
factor(Country)France                    5.9711330  0.1133891  52.661  &lt; 2e-16
factor(Country)Gabon                     3.9078481  0.1159807  33.694  &lt; 2e-16
factor(Country)Gambia                    4.1643270  0.1919143  21.699  &lt; 2e-16
factor(Country)Georgia                   3.8646784  0.0962956  40.134  &lt; 2e-16
factor(Country)Germany                   6.0846238  0.1180189  51.556  &lt; 2e-16
factor(Country)Ghana                     4.1847635  0.1059000  39.516  &lt; 2e-16
factor(Country)Greece                    5.0872183  0.1059353  48.022  &lt; 2e-16
factor(Country)Guatemala                 5.6002977  0.1119983  50.003  &lt; 2e-16
factor(Country)Guinea                    3.6005058  0.1147052  31.389  &lt; 2e-16
factor(Country)Guyana                    5.4040094  0.3579958  15.095  &lt; 2e-16
factor(Country)Haiti                     3.5124634  0.1127482  31.153  &lt; 2e-16
factor(Country)Honduras                  4.7475365  0.1104742  42.974  &lt; 2e-16
factor(Country)Hong Kong                 4.7633286  0.1183270  40.256  &lt; 2e-16
factor(Country)Hungary                   4.7623491  0.1104375  43.123  &lt; 2e-16
factor(Country)Iceland                   6.5968939  0.1420376  46.445  &lt; 2e-16
factor(Country)India                     3.9296357  0.1024876  38.343  &lt; 2e-16
factor(Country)Indonesia                 4.5421515  0.1241216  36.594  &lt; 2e-16
factor(Country)Iran                      4.2958075  0.1104123  38.907  &lt; 2e-16
factor(Country)Iraq                      4.2948231  0.1064451  40.348  &lt; 2e-16
factor(Country)Ireland                   6.2016850  0.1280798  48.420  &lt; 2e-16
factor(Country)Israel                    6.5417049  0.1171098  55.860  &lt; 2e-16
factor(Country)Italy                     5.6924783  0.1124756  50.611  &lt; 2e-16
factor(Country)Ivory Coast               3.9124690  0.1189624  32.888  &lt; 2e-16
factor(Country)Jamaica                   5.1249130  0.1243918  41.200  &lt; 2e-16
factor(Country)Japan                     5.3595351  0.1118035  47.937  &lt; 2e-16
factor(Country)Jordan                    4.6633057  0.1066468  43.727  &lt; 2e-16
factor(Country)Kazakhstan                5.2097584  0.1099608  47.378  &lt; 2e-16
factor(Country)Kenya                     3.8081710  0.1108151  34.365  &lt; 2e-16
factor(Country)Kosovo                    5.2032811  0.1079157  48.216  &lt; 2e-16
factor(Country)Kuwait                    5.6181857  0.1132115  49.626  &lt; 2e-16
factor(Country)Kyrgyzstan                4.5238677  0.1121899  40.323  &lt; 2e-16
factor(Country)Laos                      4.2236347  0.1268288  33.302  &lt; 2e-16
factor(Country)Latvia                    4.8927851  0.1101146  44.434  &lt; 2e-16
factor(Country)Lebanon                   4.4730977  0.1064691  42.013  &lt; 2e-16
factor(Country)Lesotho                   3.4551273  0.1381658  25.007  &lt; 2e-16
factor(Country)Liberia                   3.6136636  0.1163494  31.059  &lt; 2e-16
factor(Country)Libya                     4.9437026  0.1349220  36.641  &lt; 2e-16
factor(Country)Lithuania                 5.3676585  0.1086000  49.426  &lt; 2e-16
factor(Country)Luxembourg                6.2657070  0.1243486  50.388  &lt; 2e-16
factor(Country)Macedonia                 4.5770217  0.1691481  27.059  &lt; 2e-16
factor(Country)Madagascar                3.5635177  0.1073258  33.203  &lt; 2e-16
factor(Country)Malawi                    3.5065607  0.1071591  32.723  &lt; 2e-16
factor(Country)Malaysia                  5.0907068  0.1142682  44.551  &lt; 2e-16
factor(Country)Maldives                  4.4353574  0.2165641  20.481  &lt; 2e-16
factor(Country)Mali                      3.7181658  0.1066120  34.876  &lt; 2e-16
factor(Country)Malta                     5.5142193  0.1338675  41.192  &lt; 2e-16
factor(Country)Mauritania                3.9419920  0.1060932  37.156  &lt; 2e-16
factor(Country)Mauritius                 5.0784706  0.1338492  37.942  &lt; 2e-16
factor(Country)Mexico                    6.1580344  0.1076325  57.214  &lt; 2e-16
factor(Country)Moldova                   5.1323354  0.1067917  48.059  &lt; 2e-16
factor(Country)Mongolia                  4.3812961  0.1198880  36.545  &lt; 2e-16
factor(Country)Montenegro                4.8271069  0.1099339  43.909  &lt; 2e-16
factor(Country)Morocco                   4.6025920  0.1111512  41.408  &lt; 2e-16
factor(Country)Mozambique                4.1106101  0.1231291  33.385  &lt; 2e-16
factor(Country)Myanmar                   3.6345704  0.1464043  24.826  &lt; 2e-16
factor(Country)Namibia                   4.0332056  0.1324164  30.458  &lt; 2e-16
factor(Country)Nepal                     4.1376678  0.1105728  37.420  &lt; 2e-16
factor(Country)Netherlands               6.5905817  0.1276557  51.628  &lt; 2e-16
factor(Country)New Zealand               6.4147198  0.1291228  49.679  &lt; 2e-16
factor(Country)Nicaragua                 5.0035702  0.1126682  44.410  &lt; 2e-16
factor(Country)Niger                     3.7129228  0.1026082  36.185  &lt; 2e-16
factor(Country)Nigeria                   4.4421077  0.1102409  40.295  &lt; 2e-16
factor(Country)North Cyprus              5.0113952  0.1334506  37.552  &lt; 2e-16
factor(Country)North Macedonia           4.3361669  0.1292348  33.553  &lt; 2e-16
factor(Country)Northern Cyprus           5.1584090  0.2579622  19.997  &lt; 2e-16
factor(Country)Norway                    6.6568125  0.1343373  49.553  &lt; 2e-16
factor(Country)Oman                      6.2141168  0.2553142  24.339  &lt; 2e-16
factor(Country)Pakistan                  4.8639273  0.1009399  48.186  &lt; 2e-16
factor(Country)Palestinian Territories   4.2284746  0.1014159  41.694  &lt; 2e-16
factor(Country)Panama                    5.9979789  0.1131842  52.993  &lt; 2e-16
factor(Country)Paraguay                  4.9021823  0.1151642  42.567  &lt; 2e-16
factor(Country)Peru                      5.0745054  0.1067105  47.554  &lt; 2e-16
factor(Country)Philippines               4.5576953  0.1112403  40.972  &lt; 2e-16
factor(Country)Poland                    5.2532288  0.1146767  45.809  &lt; 2e-16
factor(Country)Portugal                  4.7829964  0.1144554  41.789  &lt; 2e-16
factor(Country)Puerto Rico               6.4367509  0.3566551  18.048  &lt; 2e-16
factor(Country)Qatar                     5.8301536  0.1382972  42.157  &lt; 2e-16
factor(Country)Romania                   5.0143189  0.1072964  46.733  &lt; 2e-16
factor(Country)Russia                    5.0575561  0.1081173  46.778  &lt; 2e-16
factor(Country)Rwanda                    2.9659584  0.1098749  26.994  &lt; 2e-16
factor(Country)Saudi Arabia              5.9205005  0.1086328  54.500  &lt; 2e-16
factor(Country)Senegal                   3.9099021  0.1042317  37.512  &lt; 2e-16
factor(Country)Serbia                    4.7601169  0.1109016  42.922  &lt; 2e-16
factor(Country)Sierra Leone              3.6283592  0.1085463  33.427  &lt; 2e-16
factor(Country)Singapore                 5.7598200  0.1189326  48.429  &lt; 2e-16
factor(Country)Slovakia                  5.4876867  0.1181608  46.443  &lt; 2e-16
factor(Country)Slovenia                  5.2731942  0.1204145  43.792  &lt; 2e-16
factor(Country)Somalia                   4.5753025  0.1669689  27.402  &lt; 2e-16
factor(Country)Somaliland region         4.3331766  0.1692613  25.601  &lt; 2e-16
factor(Country)Somaliland Region         4.5244147  0.3579569  12.640  &lt; 2e-16
factor(Country)South Africa              4.2689602  0.1078145  39.595  &lt; 2e-16
factor(Country)South Korea               5.3642818  0.1066032  50.320  &lt; 2e-16
factor(Country)South Sudan               3.0480296  0.1487434  20.492  &lt; 2e-16
factor(Country)Spain                     5.8440208  0.1137279  51.386  &lt; 2e-16
factor(Country)Sri Lanka                 3.6053055  0.1164882  30.950  &lt; 2e-16
factor(Country)Sudan                     3.9018603  0.1320065  29.558  &lt; 2e-16
factor(Country)Suriname                  5.6668293  0.2118123  26.754  &lt; 2e-16
factor(Country)Swaziland                 3.9889780  0.1541751  25.873  &lt; 2e-16
factor(Country)Sweden                    6.5092878  0.1222005  53.267  &lt; 2e-16
factor(Country)Switzerland               6.7106777  0.1330836  50.425  &lt; 2e-16
factor(Country)Syria                     3.3290802  0.1208696  27.543  &lt; 2e-16
factor(Country)Taiwan                    5.7985707  0.1891989  30.648  &lt; 2e-16
factor(Country)Taiwan Province of China  5.7373774  0.1254245  45.744  &lt; 2e-16
factor(Country)Tajikistan                4.3063086  0.1070618  40.223  &lt; 2e-16
factor(Country)Tanzania                  3.1016120  0.1086195  28.555  &lt; 2e-16
factor(Country)Thailand                  5.3307254  0.1293833  41.201  &lt; 2e-16
factor(Country)Togo                      3.1202358  0.1088467  28.666  &lt; 2e-16
factor(Country)Trinidad &amp; Tobago         5.4404957  0.2619105  20.772  &lt; 2e-16
factor(Country)Trinidad and Tobago       5.5541091  0.1461735  37.997  &lt; 2e-16
factor(Country)Tunisia                   4.3698478  0.1054453  41.442  &lt; 2e-16
factor(Country)Turkey                    4.8195858  0.1043079  46.205  &lt; 2e-16
factor(Country)Turkmenistan              4.8957864  0.1229627  39.815  &lt; 2e-16
factor(Country)Uganda                    3.6437792  0.1084104  33.611  &lt; 2e-16
factor(Country)Ukraine                   4.2691965  0.1074812  39.720  &lt; 2e-16
factor(Country)United Arab Emirates      6.0799862  0.1159180  52.451  &lt; 2e-16
factor(Country)United Kingdom            6.1061577  0.1264039  48.307  &lt; 2e-16
factor(Country)United States             6.3502562  0.1191061  53.316  &lt; 2e-16
factor(Country)Uruguay                   5.5844380  0.1131549  49.352  &lt; 2e-16
factor(Country)Uzbekistan                5.0883458  0.1191178  42.717  &lt; 2e-16
factor(Country)Venezuela                 5.5486294  0.1089856  50.912  &lt; 2e-16
factor(Country)Vietnam                   4.6188827  0.1108121  41.682  &lt; 2e-16
factor(Country)Yemen                     3.4568527  0.1052388  32.848  &lt; 2e-16
factor(Country)Zambia                    4.0170102  0.1073766  37.410  &lt; 2e-16
factor(Country)Zimbabwe                  3.4956636  0.1054705  33.144  &lt; 2e-16
                                           
Life_Exp                                ***
Corruption                              ***
Freedom                                 ***
Generosity                              ** 
Support                                 ***
GDP                                     ** 
factor(Country)Afghanistan              ***
factor(Country)Albania                  ***
factor(Country)Algeria                  ***
factor(Country)Angola                   ***
factor(Country)Argentina                ***
factor(Country)Armenia                  ***
factor(Country)Australia                ***
factor(Country)Austria                  ***
factor(Country)Azerbaijan               ***
factor(Country)Bahrain                  ***
factor(Country)Bangladesh               ***
factor(Country)Belarus                  ***
factor(Country)Belgium                  ***
factor(Country)Belize                   ***
factor(Country)Benin                    ***
factor(Country)Bhutan                   ***
factor(Country)Bolivia                  ***
factor(Country)Bosnia and Herzegovina   ***
factor(Country)Botswana                 ***
factor(Country)Brazil                   ***
factor(Country)Bulgaria                 ***
factor(Country)Burkina Faso             ***
factor(Country)Burundi                  ***
factor(Country)Cambodia                 ***
factor(Country)Cameroon                 ***
factor(Country)Canada                   ***
factor(Country)Central African Republic ***
factor(Country)Chad                     ***
factor(Country)Chile                    ***
factor(Country)China                    ***
factor(Country)Colombia                 ***
factor(Country)Comoros                  ***
factor(Country)Congo (Brazzaville)      ***
factor(Country)Congo (Kinshasa)         ***
factor(Country)Costa Rica               ***
factor(Country)Croatia                  ***
factor(Country)Cuba                     ***
factor(Country)Cyprus                   ***
factor(Country)Czech Republic           ***
factor(Country)Denmark                  ***
factor(Country)Djibouti                 ***
factor(Country)Dominican Republic       ***
factor(Country)Ecuador                  ***
factor(Country)Egypt                    ***
factor(Country)El Salvador              ***
factor(Country)Estonia                  ***
factor(Country)Ethiopia                 ***
factor(Country)Finland                  ***
factor(Country)France                   ***
factor(Country)Gabon                    ***
factor(Country)Gambia                   ***
factor(Country)Georgia                  ***
factor(Country)Germany                  ***
factor(Country)Ghana                    ***
factor(Country)Greece                   ***
factor(Country)Guatemala                ***
factor(Country)Guinea                   ***
factor(Country)Guyana                   ***
factor(Country)Haiti                    ***
factor(Country)Honduras                 ***
factor(Country)Hong Kong                ***
factor(Country)Hungary                  ***
factor(Country)Iceland                  ***
factor(Country)India                    ***
factor(Country)Indonesia                ***
factor(Country)Iran                     ***
factor(Country)Iraq                     ***
factor(Country)Ireland                  ***
factor(Country)Israel                   ***
factor(Country)Italy                    ***
factor(Country)Ivory Coast              ***
factor(Country)Jamaica                  ***
factor(Country)Japan                    ***
factor(Country)Jordan                   ***
factor(Country)Kazakhstan               ***
factor(Country)Kenya                    ***
factor(Country)Kosovo                   ***
factor(Country)Kuwait                   ***
factor(Country)Kyrgyzstan               ***
factor(Country)Laos                     ***
factor(Country)Latvia                   ***
factor(Country)Lebanon                  ***
factor(Country)Lesotho                  ***
factor(Country)Liberia                  ***
factor(Country)Libya                    ***
factor(Country)Lithuania                ***
factor(Country)Luxembourg               ***
factor(Country)Macedonia                ***
factor(Country)Madagascar               ***
factor(Country)Malawi                   ***
factor(Country)Malaysia                 ***
factor(Country)Maldives                 ***
factor(Country)Mali                     ***
factor(Country)Malta                    ***
factor(Country)Mauritania               ***
factor(Country)Mauritius                ***
factor(Country)Mexico                   ***
factor(Country)Moldova                  ***
factor(Country)Mongolia                 ***
factor(Country)Montenegro               ***
factor(Country)Morocco                  ***
factor(Country)Mozambique               ***
factor(Country)Myanmar                  ***
factor(Country)Namibia                  ***
factor(Country)Nepal                    ***
factor(Country)Netherlands              ***
factor(Country)New Zealand              ***
factor(Country)Nicaragua                ***
factor(Country)Niger                    ***
factor(Country)Nigeria                  ***
factor(Country)North Cyprus             ***
factor(Country)North Macedonia          ***
factor(Country)Northern Cyprus          ***
factor(Country)Norway                   ***
factor(Country)Oman                     ***
factor(Country)Pakistan                 ***
factor(Country)Palestinian Territories  ***
factor(Country)Panama                   ***
factor(Country)Paraguay                 ***
factor(Country)Peru                     ***
factor(Country)Philippines              ***
factor(Country)Poland                   ***
factor(Country)Portugal                 ***
factor(Country)Puerto Rico              ***
factor(Country)Qatar                    ***
factor(Country)Romania                  ***
factor(Country)Russia                   ***
factor(Country)Rwanda                   ***
factor(Country)Saudi Arabia             ***
factor(Country)Senegal                  ***
factor(Country)Serbia                   ***
factor(Country)Sierra Leone             ***
factor(Country)Singapore                ***
factor(Country)Slovakia                 ***
factor(Country)Slovenia                 ***
factor(Country)Somalia                  ***
factor(Country)Somaliland region        ***
factor(Country)Somaliland Region        ***
factor(Country)South Africa             ***
factor(Country)South Korea              ***
factor(Country)South Sudan              ***
factor(Country)Spain                    ***
factor(Country)Sri Lanka                ***
factor(Country)Sudan                    ***
factor(Country)Suriname                 ***
factor(Country)Swaziland                ***
factor(Country)Sweden                   ***
factor(Country)Switzerland              ***
factor(Country)Syria                    ***
factor(Country)Taiwan                   ***
factor(Country)Taiwan Province of China ***
factor(Country)Tajikistan               ***
factor(Country)Tanzania                 ***
factor(Country)Thailand                 ***
factor(Country)Togo                     ***
factor(Country)Trinidad &amp; Tobago        ***
factor(Country)Trinidad and Tobago      ***
factor(Country)Tunisia                  ***
factor(Country)Turkey                   ***
factor(Country)Turkmenistan             ***
factor(Country)Uganda                   ***
factor(Country)Ukraine                  ***
factor(Country)United Arab Emirates     ***
factor(Country)United Kingdom           ***
factor(Country)United States            ***
factor(Country)Uruguay                  ***
factor(Country)Uzbekistan               ***
factor(Country)Venezuela                ***
factor(Country)Vietnam                  ***
factor(Country)Yemen                    ***
factor(Country)Zambia                   ***
factor(Country)Zimbabwe                 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3502 on 2190 degrees of freedom
Multiple R-squared:  0.9963,    Adjusted R-squared:  0.996 
F-statistic:  3323 on 178 and 2190 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fixed &lt;- plm(Happy, data = dataPanel, model = &quot;within&quot;)
summary(fixed)</code></pre>
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Happy, data = dataPanel, model = &quot;within&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-1.319433 -0.194675 -0.005154  0.191480  1.465874 

Coefficients:
              Estimate  Std. Error t-value  Pr(&gt;|t|)    
Life_Exp    0.00244629  0.00070537  3.4681 0.0005343 ***
Corruption -0.17859111  0.04151551 -4.3018 1.769e-05 ***
Freedom     0.57528099  0.07276521  7.9060 4.176e-15 ***
Generosity  0.33316883  0.10337442  3.2229 0.0012875 ** 
Support     0.26725906  0.05270122  5.0712 4.285e-07 ***
GDP        -0.00736100  0.00231426 -3.1807 0.0014897 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    288.3
Residual Sum of Squares: 268.59
R-Squared:      0.068377
Adj. R-Squared: -0.0069186
F-statistic: 26.7894 on 6 and 2190 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Display the fixed effects (constants for each country)
fixef(fixed)</code></pre>
<pre><code>             Afghanistan                  Albania                  Algeria 
                  3.1417                   4.5040                   5.0868 
                  Angola                Argentina                  Armenia 
                  3.8344                   5.7457                   4.1192 
               Australia                  Austria               Azerbaijan 
                  6.4103                   6.4268                   4.4985 
                 Bahrain               Bangladesh                  Belarus 
                  5.3661                   4.2260                   5.0515 
                 Belgium                   Belize                    Benin 
                  6.2600                   5.4297                   3.5320 
                  Bhutan                  Bolivia   Bosnia and Herzegovina 
                  4.4335                   5.1233                   4.7466 
                Botswana                   Brazil                 Bulgaria 
                  3.4164                   6.0364                   3.9805 
            Burkina Faso                  Burundi                 Cambodia 
                  3.6288                   3.0821                   3.5210 
                Cameroon                   Canada Central African Republic 
                  4.0492                   6.5274                   3.0792 
                    Chad                    Chile                    China 
                  3.6319                   5.7619                   4.4546 
                Colombia                  Comoros      Congo (Brazzaville) 
                  5.6362                   3.5684                   3.9743 
        Congo (Kinshasa)               Costa Rica                  Croatia 
                  3.8931                   6.4391                   5.1381 
                    Cuba                   Cyprus           Czech Republic 
                  4.8297                   5.4313                   5.9887 
                 Denmark                 Djibouti       Dominican Republic 
                  6.7837                   4.2122                   4.5236 
                 Ecuador                    Egypt              El Salvador 
                  5.1906                   4.0671                   5.4205 
                 Estonia                 Ethiopia                  Finland 
                  4.9901                   3.8322                   6.7489 
                  France                    Gabon                   Gambia 
                  5.9711                   3.9078                   4.1643 
                 Georgia                  Germany                    Ghana 
                  3.8647                   6.0846                   4.1848 
                  Greece                Guatemala                   Guinea 
                  5.0872                   5.6003                   3.6005 
                  Guyana                    Haiti                 Honduras 
                  5.4040                   3.5125                   4.7475 
               Hong Kong                  Hungary                  Iceland 
                  4.7633                   4.7623                   6.5969 
                   India                Indonesia                     Iran 
                  3.9296                   4.5422                   4.2958 
                    Iraq                  Ireland                   Israel 
                  4.2948                   6.2017                   6.5417 
                   Italy              Ivory Coast                  Jamaica 
                  5.6925                   3.9125                   5.1249 
                   Japan                   Jordan               Kazakhstan 
                  5.3595                   4.6633                   5.2098 
                   Kenya                   Kosovo                   Kuwait 
                  3.8082                   5.2033                   5.6182 
              Kyrgyzstan                     Laos                   Latvia 
                  4.5239                   4.2236                   4.8928 
                 Lebanon                  Lesotho                  Liberia 
                  4.4731                   3.4551                   3.6137 
                   Libya                Lithuania               Luxembourg 
                  4.9437                   5.3677                   6.2657 
               Macedonia               Madagascar                   Malawi 
                  4.5770                   3.5635                   3.5066 
                Malaysia                 Maldives                     Mali 
                  5.0907                   4.4354                   3.7182 
                   Malta               Mauritania                Mauritius 
                  5.5142                   3.9420                   5.0785 
                  Mexico                  Moldova                 Mongolia 
                  6.1580                   5.1323                   4.3813 
              Montenegro                  Morocco               Mozambique 
                  4.8271                   4.6026                   4.1106 
                 Myanmar                  Namibia                    Nepal 
                  3.6346                   4.0332                   4.1377 
             Netherlands              New Zealand                Nicaragua 
                  6.5906                   6.4147                   5.0036 
                   Niger                  Nigeria             North Cyprus 
                  3.7129                   4.4421                   5.0114 
         North Macedonia          Northern Cyprus                   Norway 
                  4.3362                   5.1584                   6.6568 
                    Oman                 Pakistan  Palestinian Territories 
                  6.2141                   4.8639                   4.2285 
                  Panama                 Paraguay                     Peru 
                  5.9980                   4.9022                   5.0745 
             Philippines                   Poland                 Portugal 
                  4.5577                   5.2532                   4.7830 
             Puerto Rico                    Qatar                  Romania 
                  6.4368                   5.8302                   5.0143 
                  Russia                   Rwanda             Saudi Arabia 
                  5.0576                   2.9660                   5.9205 
                 Senegal                   Serbia             Sierra Leone 
                  3.9099                   4.7601                   3.6284 
               Singapore                 Slovakia                 Slovenia 
                  5.7598                   5.4877                   5.2732 
                 Somalia        Somaliland region        Somaliland Region 
                  4.5753                   4.3332                   4.5244 
            South Africa              South Korea              South Sudan 
                  4.2690                   5.3643                   3.0480 
                   Spain                Sri Lanka                    Sudan 
                  5.8440                   3.6053                   3.9019 
                Suriname                Swaziland                   Sweden 
                  5.6668                   3.9890                   6.5093 
             Switzerland                    Syria                   Taiwan 
                  6.7107                   3.3291                   5.7986 
Taiwan Province of China               Tajikistan                 Tanzania 
                  5.7374                   4.3063                   3.1016 
                Thailand                     Togo        Trinidad &amp; Tobago 
                  5.3307                   3.1202                   5.4405 
     Trinidad and Tobago                  Tunisia                   Turkey 
                  5.5541                   4.3698                   4.8196 
            Turkmenistan                   Uganda                  Ukraine 
                  4.8958                   3.6438                   4.2692 
    United Arab Emirates           United Kingdom            United States 
                  6.0800                   6.1062                   6.3503 
                 Uruguay               Uzbekistan                Venezuela 
                  5.5844                   5.0883                   5.5486 
                 Vietnam                    Yemen                   Zambia 
                  4.6189                   3.4569                   4.0170 
                Zimbabwe 
                  3.4957 </code></pre>
<pre class="r"><code># Testing for fixed effects, null: OLS better than fixed
pFtest(fixed, ols)</code></pre>
<pre><code>
    F test for individual effects

data:  Happy
F = 56.911, df1 = 171, df2 = 2190, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>random &lt;- plm(Happy, data = dataPanel, model = &quot;random&quot;)
summary(random)</code></pre>
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora&#39;s transformation)

Call:
plm(formula = Happy, data = dataPanel, model = &quot;random&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Effects:
                 var std.dev share
idiosyncratic 0.1226  0.3502 0.298
individual    0.2896  0.5381 0.702
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4546  0.8343  0.8394  0.8310  0.8441  0.8441 

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-1.40761 -0.23130  0.03251  0.00156  0.24891  1.45420 

Coefficients:
               Estimate  Std. Error z-value  Pr(&gt;|z|)    
(Intercept)  4.52739332  0.08146015 55.5780 &lt; 2.2e-16 ***
Life_Exp     0.00372095  0.00073931  5.0330 4.828e-07 ***
Corruption  -0.25469086  0.04390749 -5.8006 6.607e-09 ***
Freedom      0.69916421  0.07604459  9.1941 &lt; 2.2e-16 ***
Generosity   0.47369191  0.10519647  4.5029 6.702e-06 ***
Support      0.45849056  0.05476706  8.3716 &lt; 2.2e-16 ***
GDP         -0.00420249  0.00246376 -1.7057   0.08806 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    423.87
Residual Sum of Squares: 330.94
R-Squared:      0.21952
Adj. R-Squared: 0.21753
Chisq: 255.73 on 6 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code>phtest(fixed, random)</code></pre>
<pre><code>
    Hausman Test

data:  Happy
chisq = 610.5, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre class="r"><code>fixed.time &lt;- plm(Happiness ~ Life_Exp + Corruption + Freedom + Generosity +
  Support + GDP + factor(Year), data = dataPanel, model = &quot;within&quot;)
summary(fixed.time)</code></pre>
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Happiness ~ Life_Exp + Corruption + Freedom + Generosity + 
    Support + GDP + factor(Year), data = dataPanel, model = &quot;within&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.3754078 -0.1871495 -0.0016427  0.1846046  1.4181170 

Coefficients:
                   Estimate Std. Error t-value  Pr(&gt;|t|)    
Life_Exp         -0.0001644  0.0012570 -0.1308  0.895955    
Corruption       -0.2398021  0.0446644 -5.3690 8.762e-08 ***
Freedom           0.4957727  0.0772070  6.4213 1.654e-10 ***
Generosity        0.3558943  0.1113540  3.1961  0.001413 ** 
Support           0.5355574  0.0733269  7.3037 3.910e-13 ***
GDP               0.0262592  0.0147933  1.7751  0.076025 .  
factor(Year)2006 -0.3994407  0.0785759 -5.0835 4.022e-07 ***
factor(Year)2007 -0.1956599  0.0766923 -2.5512  0.010802 *  
factor(Year)2008 -0.1781047  0.0762848 -2.3347  0.019648 *  
factor(Year)2009 -0.1421490  0.0758518 -1.8740  0.061060 .  
factor(Year)2010 -0.1858386  0.0750593 -2.4759  0.013366 *  
factor(Year)2011 -0.1591846  0.0741103 -2.1479  0.031829 *  
factor(Year)2012 -0.2104516  0.0742632 -2.8339  0.004641 ** 
factor(Year)2013 -0.2436931  0.0743913 -3.2758  0.001070 ** 
factor(Year)2014 -0.2148011  0.0742447 -2.8932  0.003852 ** 
factor(Year)2015 -0.1933155  0.1477906 -1.3080  0.190999    
factor(Year)2016 -0.0794915  0.1504477 -0.5284  0.597299    
factor(Year)2017 -0.3197142  0.1466773 -2.1797  0.029386 *  
factor(Year)2018 -0.3070081  0.1455777 -2.1089  0.035068 *  
factor(Year)2019 -0.2335616  0.1460732 -1.5989  0.109980    
factor(Year)2020  0.0806453  0.1478290  0.5455  0.585445    
factor(Year)2021  0.1091014  0.1471254  0.7416  0.458438    
factor(Year)2022  0.1091014  0.1471254  0.7416  0.458438    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    288.3
Residual Sum of Squares: 258.8
R-Squared:      0.10233
Adj. R-Squared: 0.022193
F-statistic: 10.7706 on 23 and 2173 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Testing time-fixed effects. The null is that no time-fixed effects are needed
pFtest(fixed.time, fixed)</code></pre>
<pre><code>
    F test for individual effects

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +  ...
F = 4.8354, df1 = 17, df2 = 2173, p-value = 2.586e-10
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>plmtest(fixed, c(&quot;time&quot;), type = (&quot;bp&quot;))</code></pre>
<pre><code>
    Lagrange Multiplier Test - time effects (Breusch-Pagan) for unbalanced
    panels

data:  Happy
chisq = 2205.3, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>pool &lt;- plm(Happy, data = dataPanel, model = &quot;pooling&quot;)
summary(pool)</code></pre>
<pre><code>Pooling Model

Call:
plm(formula = Happy, data = dataPanel, model = &quot;pooling&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-2.745531 -0.511638  0.010476  0.531244  3.272865 

Coefficients:
              Estimate Std. Error  t-value  Pr(&gt;|t|)    
(Intercept)  2.0240699  0.0872059  23.2102 &lt; 2.2e-16 ***
Life_Exp     0.0164728  0.0011952  13.7822 &lt; 2.2e-16 ***
Corruption  -1.1032484  0.0748057 -14.7482 &lt; 2.2e-16 ***
Freedom      1.4813292  0.1104290  13.4143 &lt; 2.2e-16 ***
Generosity   0.8550134  0.1139882   7.5009 8.920e-14 ***
Support      2.4115613  0.0747844  32.2469 &lt; 2.2e-16 ***
GDP          0.0317194  0.0049169   6.4511 1.343e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    2951
Residual Sum of Squares: 1462.1
R-Squared:      0.50454
Adj. R-Squared: 0.50328
F-statistic: 400.713 on 6 and 2361 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Breusch-Pagan Lagrange Multiplier for random effects. Null is no panel effect (i.e. OLS better).
plmtest(pool, type = c(&quot;bp&quot;))</code></pre>
<pre><code>
    Lagrange Multiplier Test - (Breusch-Pagan) for unbalanced panels

data:  Happy
chisq = 5638.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>fixed &lt;- plm(Happy, data = dataPanel, model = &quot;within&quot;)
pcdtest(fixed, test = c(&quot;lm&quot;))</code></pre>
<pre><code>
    Breusch-Pagan LM test for cross-sectional dependence in panels

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP
chisq = NA, df = 13910, p-value = NA
alternative hypothesis: cross-sectional dependence</code></pre>
<pre class="r"><code>pcdtest(fixed, test = c(&quot;cd&quot;))</code></pre>
<pre><code>
    Pesaran CD test for cross-sectional dependence in panels

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP
z = NA, p-value = NA
alternative hypothesis: cross-sectional dependence</code></pre>
<pre class="r"><code>pbgtest(fixed)</code></pre>
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Happy
chisq = 633.05, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
<pre class="r"><code>adf.test(dataPanel$Happiness, k = 2)</code></pre>
<pre><code>
    Augmented Dickey-Fuller Test

data:  dataPanel$Happiness
Dickey-Fuller = -10.059, Lag order = 2, p-value = 0.01
alternative hypothesis: stationary</code></pre>
<pre class="r"><code>bptest(Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +
  GDP + factor(Country), data = dataPanel, studentize = F)</code></pre>
<pre><code>
    Breusch-Pagan test

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP + factor(Country)
BP = 1239, df = 177, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code># Original coefficients
coeftest(random)</code></pre>
<pre><code>
t test of coefficients:

               Estimate  Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.52739332  0.08146015 55.5780 &lt; 2.2e-16 ***
Life_Exp     0.00372095  0.00073931  5.0330 5.192e-07 ***
Corruption  -0.25469086  0.04390749 -5.8006 7.492e-09 ***
Freedom      0.69916421  0.07604459  9.1941 &lt; 2.2e-16 ***
Generosity   0.47369191  0.10519647  4.5029 7.028e-06 ***
Support      0.45849056  0.05476706  8.3716 &lt; 2.2e-16 ***
GDP         -0.00420249  0.00246376 -1.7057   0.08819 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients
coeftest(random, vcovHC)</code></pre>
<pre><code>
t test of coefficients:

              Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.5273933  0.1314252 34.4484 &lt; 2.2e-16 ***
Life_Exp     0.0037210  0.0010952  3.3974 0.0006916 ***
Corruption  -0.2546909  0.0526287 -4.8394 1.386e-06 ***
Freedom      0.6991642  0.1517424  4.6076 4.291e-06 ***
Generosity   0.4736919  0.1728910  2.7398 0.0061933 ** 
Support      0.4584906  0.0688289  6.6613 3.365e-11 ***
GDP         -0.0042025  0.0047703 -0.8810 0.3784204    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients, type 3
coeftest(random, vcovHC(random, type = &quot;HC3&quot;))</code></pre>
<pre><code>
t test of coefficients:

              Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.5273933  0.1329494 34.0535 &lt; 2.2e-16 ***
Life_Exp     0.0037210  0.0011036  3.3717  0.000759 ***
Corruption  -0.2546909  0.0529634 -4.8088 1.614e-06 ***
Freedom      0.6991642  0.1536040  4.5517 5.591e-06 ***
Generosity   0.4736919  0.1737499  2.7263  0.006452 ** 
Support      0.4584906  0.0696099  6.5866 5.530e-11 ***
GDP         -0.0042025  0.0047833 -0.8786  0.379717    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># The following shows the HC standard errors of the coefficients
t(sapply(
  c(&quot;HC0&quot;, &quot;HC1&quot;, &quot;HC2&quot;, &quot;HC3&quot;, &quot;HC4&quot;),
  function(x) sqrt(diag(vcovHC(random, type = x)))
))</code></pre>
<pre><code>    (Intercept)    Life_Exp Corruption   Freedom Generosity    Support
HC0   0.1314252 0.001095234 0.05262869 0.1517424  0.1728910 0.06882892
HC1   0.1316199 0.001096857 0.05270665 0.1519672  0.1731471 0.06893088
HC2   0.1321807 0.001099374 0.05279520 0.1526662  0.1733191 0.06921646
HC3   0.1329494 0.001103569 0.05296335 0.1536040  0.1737499 0.06960991
HC4   0.1341083 0.001108718 0.05309691 0.1551472  0.1739099 0.07017677
            GDP
HC0 0.004770264
HC1 0.004777331
HC2 0.004776754
HC3 0.004783260
HC4 0.004778352</code></pre>
<pre class="r"><code># Original coefficients
coeftest(fixed)</code></pre>
<pre><code>
t test of coefficients:

              Estimate  Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.00244629  0.00070537  3.4681 0.0005343 ***
Corruption -0.17859111  0.04151551 -4.3018 1.769e-05 ***
Freedom     0.57528099  0.07276521  7.9060 4.176e-15 ***
Generosity  0.33316883  0.10337442  3.2229 0.0012875 ** 
Support     0.26725906  0.05270122  5.0712 4.285e-07 ***
GDP        -0.00736100  0.00231426 -3.1807 0.0014897 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients
coeftest(fixed, vcovHC)</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010750  2.2756 0.0229680 *  
Corruption -0.1785911  0.0503547 -3.5467 0.0003983 ***
Freedom     0.5752810  0.1484497  3.8753 0.0001096 ***
Generosity  0.3331688  0.1813542  1.8371 0.0663281 .  
Support     0.2672591  0.0642911  4.1570 3.348e-05 ***
GDP        -0.0073610  0.0048419 -1.5203 0.1285907    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients (Arellano)
coeftest(fixed, vcovHC(fixed, method = &quot;arellano&quot;))</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010750  2.2756 0.0229680 *  
Corruption -0.1785911  0.0503547 -3.5467 0.0003983 ***
Freedom     0.5752810  0.1484497  3.8753 0.0001096 ***
Generosity  0.3331688  0.1813542  1.8371 0.0663281 .  
Support     0.2672591  0.0642911  4.1570 3.348e-05 ***
GDP        -0.0073610  0.0048419 -1.5203 0.1285907    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients, type 3
coeftest(fixed, vcovHC(fixed, type = &quot;HC3&quot;))</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010824  2.2601 0.0239109 *  
Corruption -0.1785911  0.0506314 -3.5273 0.0004285 ***
Freedom     0.5752810  0.1500728  3.8333 0.0001300 ***
Generosity  0.3331688  0.1822724  1.8279 0.0677062 .  
Support     0.2672591  0.0648715  4.1198 3.933e-05 ***
GDP        -0.0073610  0.0048536 -1.5166 0.1295103    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># The following shows the HC standard errors of the coefficients
t(sapply(
  c(&quot;HC0&quot;, &quot;HC1&quot;, &quot;HC2&quot;, &quot;HC3&quot;, &quot;HC4&quot;),
  function(x) sqrt(diag(vcovHC(fixed, type = x)))
))</code></pre>
<pre><code>       Life_Exp Corruption   Freedom Generosity    Support         GDP
HC0 0.001075021 0.05035465 0.1484497  0.1813542 0.06429108 0.004841942
HC1 0.001076386 0.05041857 0.1486382  0.1815844 0.06437269 0.004848088
HC2 0.001078670 0.05049245 0.1492554  0.1818117 0.06457918 0.004847762
HC3 0.001082364 0.05063145 0.1500728  0.1822724 0.06487145 0.004853596
HC4 0.001087046 0.05075780 0.1514138  0.1826150 0.06527146 0.004849880</code></pre>
<pre class="r"><code>scatterplot(Happiness ~ Year | Region1, type = &quot;b&quot;, data = dataPanel1)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>[1] &quot;1356&quot; &quot;1363&quot;</code></pre>
<pre class="r"><code>plotmeans(Happiness ~ Year, data = dataPanel1)</code></pre>
<p><img src="/post/2022-04-01-r-rmarkdown/Happiness_files/figure-html/unnamed-chunk-5-2.png" width="100%" style="display: block; margin: auto;" /></p>
<pre class="r"><code>ols1 &lt;- lm(Happy, data = dataPanel1)
summary(ols1)</code></pre>
<pre><code>
Call:
lm(formula = Happy, data = dataPanel1)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.7455 -0.5116  0.0105  0.5312  3.2729 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.024070   0.087206  23.210  &lt; 2e-16 ***
Life_Exp     0.016473   0.001195  13.782  &lt; 2e-16 ***
Corruption  -1.103248   0.074806 -14.748  &lt; 2e-16 ***
Freedom      1.481329   0.110429  13.414  &lt; 2e-16 ***
Generosity   0.855013   0.113988   7.501 8.92e-14 ***
Support      2.411561   0.074784  32.247  &lt; 2e-16 ***
GDP          0.031719   0.004917   6.451 1.34e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7869 on 2361 degrees of freedom
Multiple R-squared:  0.5045,    Adjusted R-squared:  0.5033 
F-statistic: 400.7 on 6 and 2361 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fixed.dum1 &lt;- lm(Happiness ~ Life_Exp + Corruption + Freedom + Generosity +
  Support + GDP + factor(Region1) - 1, data = dataPanel1)
summary(fixed.dum1)</code></pre>
<pre><code>
Call:
lm(formula = Happiness ~ Life_Exp + Corruption + Freedom + Generosity + 
    Support + GDP + factor(Region1) - 1, data = dataPanel1)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.40495 -0.35656  0.00712  0.38667  2.68093 

Coefficients:
                              Estimate Std. Error t value Pr(&gt;|t|)    
Life_Exp                     0.0055363  0.0009845   5.623 2.09e-08 ***
Corruption                  -0.5635789  0.0606327  -9.295  &lt; 2e-16 ***
Freedom                      1.3934222  0.0898833  15.503  &lt; 2e-16 ***
Generosity                   0.4677038  0.1021943   4.577 4.97e-06 ***
Support                      1.1854451  0.0677205  17.505  &lt; 2e-16 ***
GDP                          0.0136355  0.0038657   3.527 0.000428 ***
factor(Region1)Australiasia  4.5558890  0.1610997  28.280  &lt; 2e-16 ***
factor(Region1)CEEuro        3.5838463  0.0882114  40.628  &lt; 2e-16 ***
factor(Region1)CIStates      3.2815009  0.0958218  34.246  &lt; 2e-16 ***
factor(Region1)EAsia         3.5525182  0.1035175  34.318  &lt; 2e-16 ***
factor(Region1)LAmerica      3.9148572  0.0909604  43.039  &lt; 2e-16 ***
factor(Region1)MENA          3.5940755  0.0823641  43.636  &lt; 2e-16 ***
factor(Region1)NAmerica      4.6941285  0.1379158  34.036  &lt; 2e-16 ***
factor(Region1)SAsia         2.8922108  0.0929858  31.104  &lt; 2e-16 ***
factor(Region1)SEAsia        3.1330183  0.1040379  30.114  &lt; 2e-16 ***
factor(Region1)SSA           2.6153031  0.0741556  35.268  &lt; 2e-16 ***
factor(Region1)WEuro         4.3611653  0.1004484  43.417  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.6112 on 2351 degrees of freedom
Multiple R-squared:  0.9879,    Adjusted R-squared:  0.9879 
F-statistic: 1.133e+04 on 17 and 2351 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>fixed1 &lt;- plm(Happy, data = dataPanel, model = &quot;within&quot;)
summary(fixed1)</code></pre>
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Happy, data = dataPanel, model = &quot;within&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-1.319433 -0.194675 -0.005154  0.191480  1.465874 

Coefficients:
              Estimate  Std. Error t-value  Pr(&gt;|t|)    
Life_Exp    0.00244629  0.00070537  3.4681 0.0005343 ***
Corruption -0.17859111  0.04151551 -4.3018 1.769e-05 ***
Freedom     0.57528099  0.07276521  7.9060 4.176e-15 ***
Generosity  0.33316883  0.10337442  3.2229 0.0012875 ** 
Support     0.26725906  0.05270122  5.0712 4.285e-07 ***
GDP        -0.00736100  0.00231426 -3.1807 0.0014897 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    288.3
Residual Sum of Squares: 268.59
R-Squared:      0.068377
Adj. R-Squared: -0.0069186
F-statistic: 26.7894 on 6 and 2190 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Display the fixed effects (constants for each country)
fixef(fixed1)</code></pre>
<pre><code>             Afghanistan                  Albania                  Algeria 
                  3.1417                   4.5040                   5.0868 
                  Angola                Argentina                  Armenia 
                  3.8344                   5.7457                   4.1192 
               Australia                  Austria               Azerbaijan 
                  6.4103                   6.4268                   4.4985 
                 Bahrain               Bangladesh                  Belarus 
                  5.3661                   4.2260                   5.0515 
                 Belgium                   Belize                    Benin 
                  6.2600                   5.4297                   3.5320 
                  Bhutan                  Bolivia   Bosnia and Herzegovina 
                  4.4335                   5.1233                   4.7466 
                Botswana                   Brazil                 Bulgaria 
                  3.4164                   6.0364                   3.9805 
            Burkina Faso                  Burundi                 Cambodia 
                  3.6288                   3.0821                   3.5210 
                Cameroon                   Canada Central African Republic 
                  4.0492                   6.5274                   3.0792 
                    Chad                    Chile                    China 
                  3.6319                   5.7619                   4.4546 
                Colombia                  Comoros      Congo (Brazzaville) 
                  5.6362                   3.5684                   3.9743 
        Congo (Kinshasa)               Costa Rica                  Croatia 
                  3.8931                   6.4391                   5.1381 
                    Cuba                   Cyprus           Czech Republic 
                  4.8297                   5.4313                   5.9887 
                 Denmark                 Djibouti       Dominican Republic 
                  6.7837                   4.2122                   4.5236 
                 Ecuador                    Egypt              El Salvador 
                  5.1906                   4.0671                   5.4205 
                 Estonia                 Ethiopia                  Finland 
                  4.9901                   3.8322                   6.7489 
                  France                    Gabon                   Gambia 
                  5.9711                   3.9078                   4.1643 
                 Georgia                  Germany                    Ghana 
                  3.8647                   6.0846                   4.1848 
                  Greece                Guatemala                   Guinea 
                  5.0872                   5.6003                   3.6005 
                  Guyana                    Haiti                 Honduras 
                  5.4040                   3.5125                   4.7475 
               Hong Kong                  Hungary                  Iceland 
                  4.7633                   4.7623                   6.5969 
                   India                Indonesia                     Iran 
                  3.9296                   4.5422                   4.2958 
                    Iraq                  Ireland                   Israel 
                  4.2948                   6.2017                   6.5417 
                   Italy              Ivory Coast                  Jamaica 
                  5.6925                   3.9125                   5.1249 
                   Japan                   Jordan               Kazakhstan 
                  5.3595                   4.6633                   5.2098 
                   Kenya                   Kosovo                   Kuwait 
                  3.8082                   5.2033                   5.6182 
              Kyrgyzstan                     Laos                   Latvia 
                  4.5239                   4.2236                   4.8928 
                 Lebanon                  Lesotho                  Liberia 
                  4.4731                   3.4551                   3.6137 
                   Libya                Lithuania               Luxembourg 
                  4.9437                   5.3677                   6.2657 
               Macedonia               Madagascar                   Malawi 
                  4.5770                   3.5635                   3.5066 
                Malaysia                 Maldives                     Mali 
                  5.0907                   4.4354                   3.7182 
                   Malta               Mauritania                Mauritius 
                  5.5142                   3.9420                   5.0785 
                  Mexico                  Moldova                 Mongolia 
                  6.1580                   5.1323                   4.3813 
              Montenegro                  Morocco               Mozambique 
                  4.8271                   4.6026                   4.1106 
                 Myanmar                  Namibia                    Nepal 
                  3.6346                   4.0332                   4.1377 
             Netherlands              New Zealand                Nicaragua 
                  6.5906                   6.4147                   5.0036 
                   Niger                  Nigeria             North Cyprus 
                  3.7129                   4.4421                   5.0114 
         North Macedonia          Northern Cyprus                   Norway 
                  4.3362                   5.1584                   6.6568 
                    Oman                 Pakistan  Palestinian Territories 
                  6.2141                   4.8639                   4.2285 
                  Panama                 Paraguay                     Peru 
                  5.9980                   4.9022                   5.0745 
             Philippines                   Poland                 Portugal 
                  4.5577                   5.2532                   4.7830 
             Puerto Rico                    Qatar                  Romania 
                  6.4368                   5.8302                   5.0143 
                  Russia                   Rwanda             Saudi Arabia 
                  5.0576                   2.9660                   5.9205 
                 Senegal                   Serbia             Sierra Leone 
                  3.9099                   4.7601                   3.6284 
               Singapore                 Slovakia                 Slovenia 
                  5.7598                   5.4877                   5.2732 
                 Somalia        Somaliland region        Somaliland Region 
                  4.5753                   4.3332                   4.5244 
            South Africa              South Korea              South Sudan 
                  4.2690                   5.3643                   3.0480 
                   Spain                Sri Lanka                    Sudan 
                  5.8440                   3.6053                   3.9019 
                Suriname                Swaziland                   Sweden 
                  5.6668                   3.9890                   6.5093 
             Switzerland                    Syria                   Taiwan 
                  6.7107                   3.3291                   5.7986 
Taiwan Province of China               Tajikistan                 Tanzania 
                  5.7374                   4.3063                   3.1016 
                Thailand                     Togo        Trinidad &amp; Tobago 
                  5.3307                   3.1202                   5.4405 
     Trinidad and Tobago                  Tunisia                   Turkey 
                  5.5541                   4.3698                   4.8196 
            Turkmenistan                   Uganda                  Ukraine 
                  4.8958                   3.6438                   4.2692 
    United Arab Emirates           United Kingdom            United States 
                  6.0800                   6.1062                   6.3503 
                 Uruguay               Uzbekistan                Venezuela 
                  5.5844                   5.0883                   5.5486 
                 Vietnam                    Yemen                   Zambia 
                  4.6189                   3.4569                   4.0170 
                Zimbabwe 
                  3.4957 </code></pre>
<pre class="r"><code># Testing for fixed effects, null: OLS better than fixed
pFtest(fixed1, ols1)</code></pre>
<pre><code>
    F test for individual effects

data:  Happy
F = 56.911, df1 = 171, df2 = 2190, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>random1 &lt;- plm(Happy, data = dataPanel, model = &quot;random&quot;)
summary(random1)</code></pre>
<pre><code>Oneway (individual) effect Random Effect Model 
   (Swamy-Arora&#39;s transformation)

Call:
plm(formula = Happy, data = dataPanel, model = &quot;random&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Effects:
                 var std.dev share
idiosyncratic 0.1226  0.3502 0.298
individual    0.2896  0.5381 0.702
theta:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.4546  0.8343  0.8394  0.8310  0.8441  0.8441 

Residuals:
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
-1.40761 -0.23130  0.03251  0.00156  0.24891  1.45420 

Coefficients:
               Estimate  Std. Error z-value  Pr(&gt;|z|)    
(Intercept)  4.52739332  0.08146015 55.5780 &lt; 2.2e-16 ***
Life_Exp     0.00372095  0.00073931  5.0330 4.828e-07 ***
Corruption  -0.25469086  0.04390749 -5.8006 6.607e-09 ***
Freedom      0.69916421  0.07604459  9.1941 &lt; 2.2e-16 ***
Generosity   0.47369191  0.10519647  4.5029 6.702e-06 ***
Support      0.45849056  0.05476706  8.3716 &lt; 2.2e-16 ***
GDP         -0.00420249  0.00246376 -1.7057   0.08806 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    423.87
Residual Sum of Squares: 330.94
R-Squared:      0.21952
Adj. R-Squared: 0.21753
Chisq: 255.73 on 6 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code>phtest(fixed1, random1)</code></pre>
<pre><code>
    Hausman Test

data:  Happy
chisq = 610.5, df = 6, p-value &lt; 2.2e-16
alternative hypothesis: one model is inconsistent</code></pre>
<pre class="r"><code>fixed.time1 &lt;- plm(Happiness ~ Life_Exp + Corruption + Freedom + Generosity +
  Support + GDP + factor(Year),
data = dataPanel,
model = &quot;within&quot;
)
summary(fixed.time1)</code></pre>
<pre><code>Oneway (individual) effect Within Model

Call:
plm(formula = Happiness ~ Life_Exp + Corruption + Freedom + Generosity + 
    Support + GDP + factor(Year), data = dataPanel, model = &quot;within&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
      Min.    1st Qu.     Median    3rd Qu.       Max. 
-1.3754078 -0.1871495 -0.0016427  0.1846046  1.4181170 

Coefficients:
                   Estimate Std. Error t-value  Pr(&gt;|t|)    
Life_Exp         -0.0001644  0.0012570 -0.1308  0.895955    
Corruption       -0.2398021  0.0446644 -5.3690 8.762e-08 ***
Freedom           0.4957727  0.0772070  6.4213 1.654e-10 ***
Generosity        0.3558943  0.1113540  3.1961  0.001413 ** 
Support           0.5355574  0.0733269  7.3037 3.910e-13 ***
GDP               0.0262592  0.0147933  1.7751  0.076025 .  
factor(Year)2006 -0.3994407  0.0785759 -5.0835 4.022e-07 ***
factor(Year)2007 -0.1956599  0.0766923 -2.5512  0.010802 *  
factor(Year)2008 -0.1781047  0.0762848 -2.3347  0.019648 *  
factor(Year)2009 -0.1421490  0.0758518 -1.8740  0.061060 .  
factor(Year)2010 -0.1858386  0.0750593 -2.4759  0.013366 *  
factor(Year)2011 -0.1591846  0.0741103 -2.1479  0.031829 *  
factor(Year)2012 -0.2104516  0.0742632 -2.8339  0.004641 ** 
factor(Year)2013 -0.2436931  0.0743913 -3.2758  0.001070 ** 
factor(Year)2014 -0.2148011  0.0742447 -2.8932  0.003852 ** 
factor(Year)2015 -0.1933155  0.1477906 -1.3080  0.190999    
factor(Year)2016 -0.0794915  0.1504477 -0.5284  0.597299    
factor(Year)2017 -0.3197142  0.1466773 -2.1797  0.029386 *  
factor(Year)2018 -0.3070081  0.1455777 -2.1089  0.035068 *  
factor(Year)2019 -0.2335616  0.1460732 -1.5989  0.109980    
factor(Year)2020  0.0806453  0.1478290  0.5455  0.585445    
factor(Year)2021  0.1091014  0.1471254  0.7416  0.458438    
factor(Year)2022  0.1091014  0.1471254  0.7416  0.458438    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    288.3
Residual Sum of Squares: 258.8
R-Squared:      0.10233
Adj. R-Squared: 0.022193
F-statistic: 10.7706 on 23 and 2173 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Testing time-fixed effects. The null is that no time-fixed effects are needed
pFtest(fixed.time1, fixed1)</code></pre>
<pre><code>
    F test for individual effects

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +  ...
F = 4.8354, df1 = 17, df2 = 2173, p-value = 2.586e-10
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>plmtest(fixed1, c(&quot;time&quot;), type = (&quot;bp&quot;))</code></pre>
<pre><code>
    Lagrange Multiplier Test - time effects (Breusch-Pagan) for unbalanced
    panels

data:  Happy
chisq = 2205.3, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>pool1 &lt;- plm(Happy, data = dataPanel, model = &quot;pooling&quot;)
summary(pool1)</code></pre>
<pre><code>Pooling Model

Call:
plm(formula = Happy, data = dataPanel, model = &quot;pooling&quot;)

Unbalanced Panel: n = 172, T = 1-17, N = 2368

Residuals:
     Min.   1st Qu.    Median   3rd Qu.      Max. 
-2.745531 -0.511638  0.010476  0.531244  3.272865 

Coefficients:
              Estimate Std. Error  t-value  Pr(&gt;|t|)    
(Intercept)  2.0240699  0.0872059  23.2102 &lt; 2.2e-16 ***
Life_Exp     0.0164728  0.0011952  13.7822 &lt; 2.2e-16 ***
Corruption  -1.1032484  0.0748057 -14.7482 &lt; 2.2e-16 ***
Freedom      1.4813292  0.1104290  13.4143 &lt; 2.2e-16 ***
Generosity   0.8550134  0.1139882   7.5009 8.920e-14 ***
Support      2.4115613  0.0747844  32.2469 &lt; 2.2e-16 ***
GDP          0.0317194  0.0049169   6.4511 1.343e-10 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Total Sum of Squares:    2951
Residual Sum of Squares: 1462.1
R-Squared:      0.50454
Adj. R-Squared: 0.50328
F-statistic: 400.713 on 6 and 2361 DF, p-value: &lt; 2.22e-16</code></pre>
<pre class="r"><code># Breusch-Pagan Lagrange Multiplier for random effects. Null is no panel effect (i.e. OLS better).
plmtest(pool1, type = c(&quot;bp&quot;))</code></pre>
<pre><code>
    Lagrange Multiplier Test - (Breusch-Pagan) for unbalanced panels

data:  Happy
chisq = 5638.9, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: significant effects</code></pre>
<pre class="r"><code>fixed1 &lt;- plm(Happy, data = dataPanel, model = &quot;within&quot;)
pcdtest(fixed1, test = c(&quot;lm&quot;))</code></pre>
<pre><code>
    Breusch-Pagan LM test for cross-sectional dependence in panels

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP
chisq = NA, df = 13910, p-value = NA
alternative hypothesis: cross-sectional dependence</code></pre>
<pre class="r"><code>pcdtest(fixed1, test = c(&quot;cd&quot;))</code></pre>
<pre><code>
    Pesaran CD test for cross-sectional dependence in panels

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP
z = NA, p-value = NA
alternative hypothesis: cross-sectional dependence</code></pre>
<pre class="r"><code>pbgtest(fixed1)</code></pre>
<pre><code>
    Breusch-Godfrey/Wooldridge test for serial correlation in panel models

data:  Happy
chisq = 633.05, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: serial correlation in idiosyncratic errors</code></pre>
<pre class="r"><code>adf.test(dataPanel1$Happiness, k = 2)</code></pre>
<pre><code>
    Augmented Dickey-Fuller Test

data:  dataPanel1$Happiness
Dickey-Fuller = -10.869, Lag order = 2, p-value = 0.01
alternative hypothesis: stationary</code></pre>
<pre class="r"><code>bptest(Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +
  GDP + factor(Region1), data = dataPanel1, studentize = F)</code></pre>
<pre><code>
    Breusch-Pagan test

data:  Happiness ~ Life_Exp + Corruption + Freedom + Generosity + Support +     GDP + factor(Region1)
BP = 301.31, df = 16, p-value &lt; 2.2e-16</code></pre>
<pre class="r"><code># Original coefficients
coeftest(random1)</code></pre>
<pre><code>
t test of coefficients:

               Estimate  Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.52739332  0.08146015 55.5780 &lt; 2.2e-16 ***
Life_Exp     0.00372095  0.00073931  5.0330 5.192e-07 ***
Corruption  -0.25469086  0.04390749 -5.8006 7.492e-09 ***
Freedom      0.69916421  0.07604459  9.1941 &lt; 2.2e-16 ***
Generosity   0.47369191  0.10519647  4.5029 7.028e-06 ***
Support      0.45849056  0.05476706  8.3716 &lt; 2.2e-16 ***
GDP         -0.00420249  0.00246376 -1.7057   0.08819 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients
coeftest(random1, vcovHC)</code></pre>
<pre><code>
t test of coefficients:

              Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.5273933  0.1314252 34.4484 &lt; 2.2e-16 ***
Life_Exp     0.0037210  0.0010952  3.3974 0.0006916 ***
Corruption  -0.2546909  0.0526287 -4.8394 1.386e-06 ***
Freedom      0.6991642  0.1517424  4.6076 4.291e-06 ***
Generosity   0.4736919  0.1728910  2.7398 0.0061933 ** 
Support      0.4584906  0.0688289  6.6613 3.365e-11 ***
GDP         -0.0042025  0.0047703 -0.8810 0.3784204    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients, type 3
coeftest(random1, vcovHC(random1, type = &quot;HC3&quot;))</code></pre>
<pre><code>
t test of coefficients:

              Estimate Std. Error t value  Pr(&gt;|t|)    
(Intercept)  4.5273933  0.1329494 34.0535 &lt; 2.2e-16 ***
Life_Exp     0.0037210  0.0011036  3.3717  0.000759 ***
Corruption  -0.2546909  0.0529634 -4.8088 1.614e-06 ***
Freedom      0.6991642  0.1536040  4.5517 5.591e-06 ***
Generosity   0.4736919  0.1737499  2.7263  0.006452 ** 
Support      0.4584906  0.0696099  6.5866 5.530e-11 ***
GDP         -0.0042025  0.0047833 -0.8786  0.379717    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># The following shows the HC standard errors of the coefficients
t(sapply(
  c(&quot;HC0&quot;, &quot;HC1&quot;, &quot;HC2&quot;, &quot;HC3&quot;, &quot;HC4&quot;),
  function(x) sqrt(diag(vcovHC(random1, type = x)))
))</code></pre>
<pre><code>    (Intercept)    Life_Exp Corruption   Freedom Generosity    Support
HC0   0.1314252 0.001095234 0.05262869 0.1517424  0.1728910 0.06882892
HC1   0.1316199 0.001096857 0.05270665 0.1519672  0.1731471 0.06893088
HC2   0.1321807 0.001099374 0.05279520 0.1526662  0.1733191 0.06921646
HC3   0.1329494 0.001103569 0.05296335 0.1536040  0.1737499 0.06960991
HC4   0.1341083 0.001108718 0.05309691 0.1551472  0.1739099 0.07017677
            GDP
HC0 0.004770264
HC1 0.004777331
HC2 0.004776754
HC3 0.004783260
HC4 0.004778352</code></pre>
<pre class="r"><code># Original coefficients
coeftest(fixed1)</code></pre>
<pre><code>
t test of coefficients:

              Estimate  Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.00244629  0.00070537  3.4681 0.0005343 ***
Corruption -0.17859111  0.04151551 -4.3018 1.769e-05 ***
Freedom     0.57528099  0.07276521  7.9060 4.176e-15 ***
Generosity  0.33316883  0.10337442  3.2229 0.0012875 ** 
Support     0.26725906  0.05270122  5.0712 4.285e-07 ***
GDP        -0.00736100  0.00231426 -3.1807 0.0014897 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients
coeftest(fixed1, vcovHC)</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010750  2.2756 0.0229680 *  
Corruption -0.1785911  0.0503547 -3.5467 0.0003983 ***
Freedom     0.5752810  0.1484497  3.8753 0.0001096 ***
Generosity  0.3331688  0.1813542  1.8371 0.0663281 .  
Support     0.2672591  0.0642911  4.1570 3.348e-05 ***
GDP        -0.0073610  0.0048419 -1.5203 0.1285907    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients (Arellano)
coeftest(fixed1, vcovHC(fixed1, method = &quot;arellano&quot;))</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010750  2.2756 0.0229680 *  
Corruption -0.1785911  0.0503547 -3.5467 0.0003983 ***
Freedom     0.5752810  0.1484497  3.8753 0.0001096 ***
Generosity  0.3331688  0.1813542  1.8371 0.0663281 .  
Support     0.2672591  0.0642911  4.1570 3.348e-05 ***
GDP        -0.0073610  0.0048419 -1.5203 0.1285907    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># Heteroskedasticity consistent coefficients, type 3
coeftest(fixed1, vcovHC(fixed1, type = &quot;HC3&quot;))</code></pre>
<pre><code>
t test of coefficients:

             Estimate Std. Error t value  Pr(&gt;|t|)    
Life_Exp    0.0024463  0.0010824  2.2601 0.0239109 *  
Corruption -0.1785911  0.0506314 -3.5273 0.0004285 ***
Freedom     0.5752810  0.1500728  3.8333 0.0001300 ***
Generosity  0.3331688  0.1822724  1.8279 0.0677062 .  
Support     0.2672591  0.0648715  4.1198 3.933e-05 ***
GDP        -0.0073610  0.0048536 -1.5166 0.1295103    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code># The following shows the HC standard errors of the coefficients
t(sapply(
  c(&quot;HC0&quot;, &quot;HC1&quot;, &quot;HC2&quot;, &quot;HC3&quot;, &quot;HC4&quot;),
  function(x) sqrt(diag(vcovHC(fixed1, type = x)))
))</code></pre>
<pre><code>       Life_Exp Corruption   Freedom Generosity    Support         GDP
HC0 0.001075021 0.05035465 0.1484497  0.1813542 0.06429108 0.004841942
HC1 0.001076386 0.05041857 0.1486382  0.1815844 0.06437269 0.004848088
HC2 0.001078670 0.05049245 0.1492554  0.1818117 0.06457918 0.004847762
HC3 0.001082364 0.05063145 0.1500728  0.1822724 0.06487145 0.004853596
HC4 0.001087046 0.05075780 0.1514138  0.1826150 0.06527146 0.004849880</code></pre>
