---
title: "Global movement of Happiness ladder with Machine learning in R"
output:
  prettydoc::html_pretty:
    theme: cayman #tactile, architect, leonids, hpstr
    highlight: vignette #github
    math: katex #latex
  html_document: default
  word_document: default
  pdf_document: 
    latex_engine: xelatex
description: |
  This blog is about the global happinness ladder capturing the changes in countries between 2002 and 2023.
author:
  - name: Job Nmadu
    url: https://jobnmadu.com/
categories:
  - R
date: "2024-07-26T01:00:00Z"
tags: [RStats, Data Science, Machine Learning, Factor analysis, Structural equation modelling]
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>
<link href="/rmarkdown-libs/lightable/lightable.css" rel="stylesheet" />


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This blog is about world happiness ladder using the world happiness report data sets (Helliwell et. al., 2024). The basic objective is to demonstrate the use of panel data which is quite distinct from cross-sectional or time series data.</p>
</div>
<div id="global-happiness-ladder" class="section level1">
<h1>Global happiness ladder</h1>
<div id="cross-sectional-happiness-ladder-for-2023" class="section level2">
<h2>Cross-sectional happiness ladder for 2023</h2>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Fixed time, it is cross-sectional</p>
</div>
<div id="times-series-vs.-panel-data-visualisation" class="section level2">
<h2>Times series vs. panel data visualisation</h2>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;" /><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-3-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Each line is a timeseries but together, it is panel data</p>
</div>
</div>
<div id="mean-global-happiness-lalder" class="section level1">
<h1>Mean global happiness lalder</h1>
<div id="cross-sectional-mean-happiness-ladder-for-2023" class="section level2">
<h2>Cross-sectional mean happiness ladder for 2023</h2>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Time is fixed, cross-sectional</p>
</div>
<div id="times-series-vs.-panel-data-visualisation-1" class="section level2">
<h2>Times series vs. panel data visualisation</h2>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;" /><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-5-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Each line is a timeseires but together, they are panel data</p>
</div>
</div>
<div id="factor-analysis-of-panel-global-happiness-ladder" class="section level1">
<h1>Factor analysis of panel global happiness ladder</h1>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;" /></p>
<pre><code>Parallel analysis suggests that the number of factors =  4  and the number of components =  NA </code></pre>
<pre><code>
Loadings:
           MR1    MR2    MR4    MR3   
Happiness   0.810                     
GDP         0.899                     
Support     0.761                     
Life_Exp    0.882                     
Freedom            0.651              
Positive           0.775              
Corruption               -0.831       
Negative                         0.550
Year                             0.487
Generosity         0.440              
Regional                              

                 MR1   MR2   MR4   MR3
SS loadings    3.286 1.687 0.909 0.731
Proportion Var 0.299 0.153 0.083 0.066
Cumulative Var 0.299 0.452 0.535 0.601</code></pre>
<img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-6-2.png" width="100%" style="display: block; margin: auto;" />
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
degree of freedom
</td>
<td style="text-align:right;">
17.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Chi-sq
</td>
<td style="text-align:right;">
132.48
</td>
</tr>
<tr>
<td style="text-align:left;">
Chi-sq/df
</td>
<td style="text-align:right;">
7.79
</td>
</tr>
<tr>
<td style="text-align:left;">
Harmonic sample size
</td>
<td style="text-align:right;">
2298.31
</td>
</tr>
<tr>
<td style="text-align:left;">
Root Mean Square
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
Probability of the empirical chi-sq
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Adjusted Root Mean Square
</td>
<td style="text-align:right;">
0.04
</td>
</tr>
<tr>
<td style="text-align:left;">
Empirical BIC
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
Sample size adjusted BIC
</td>
<td style="text-align:right;">
54.91
</td>
</tr>
<tr>
<td style="text-align:left;">
fit (SSresidual vs SSoriginal values)
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
fit applied to off diagonal elements
</td>
<td style="text-align:right;">
1.00
</td>
</tr>
<tr>
<td style="text-align:left;">
SD of the residuals
</td>
<td style="text-align:right;">
0.02
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of factors extracted
</td>
<td style="text-align:right;">
4.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of observations
</td>
<td style="text-align:right;">
2363.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Value of the minimised function
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq based on the objective function
</td>
<td style="text-align:right;">
369.96
</td>
</tr>
<tr>
<td style="text-align:left;">
p-value of observing the chi-sq
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq based on the objective function/df
</td>
<td style="text-align:right;">
6.73
</td>
</tr>
<tr>
<td style="text-align:left;">
Null model
</td>
<td style="text-align:right;">
5.32
</td>
</tr>
<tr>
<td style="text-align:left;">
df for null model
</td>
<td style="text-align:right;">
55.00
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq for null model
</td>
<td style="text-align:right;">
12542.24
</td>
</tr>
<tr>
<td style="text-align:left;">
chi-sq for null model/df
</td>
<td style="text-align:right;">
228.04
</td>
</tr>
<tr>
<td style="text-align:left;">
Tucker Lewis Index of factoring reliability
</td>
<td style="text-align:right;">
0.91
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-lower
</td>
<td style="text-align:right;">
0.09
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-upper
</td>
<td style="text-align:right;">
0.10
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-confidence interval
</td>
<td style="text-align:right;">
0.90
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-BIC
</td>
<td style="text-align:right;">
237.91
</td>
</tr>
<tr>
<td style="text-align:left;">
RMSE Approximation-empirical BIC
</td>
<td style="text-align:right;">
291.92
</td>
</tr>
<tr>
<td style="text-align:left;">
Mean item complexity
</td>
<td style="text-align:right;">
1.58
</td>
</tr>
<tr>
<td style="text-align:left;">
Kaiser Meyer Olkin Measure of Sampling Adequacy
</td>
<td style="text-align:right;">
0.81
</td>
</tr>
<tr>
<td style="text-align:left;">
Bartlett Chi
</td>
<td style="text-align:right;">
12542.24
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett p-value
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett df
</td>
<td style="text-align:right;">
55.00
</td>
</tr>
<tr>
<td style="text-align:left;">
Barlett Chi/df
</td>
<td style="text-align:right;">
228.04
</td>
</tr>
</tbody>
</table>
<pre><code>lavaan 0.6-18 ended normally after 117 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        24

                                                  Used       Total
  Number of observations                          2098        2363

Model Test User Model:
                                                      
  Test statistic                              2216.113
  Degrees of freedom                                31
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             10727.135
  Degrees of freedom                                45
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.795
  Tucker-Lewis Index (TLI)                       0.703

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -15445.704
  Loglikelihood unrestricted model (H1)     -14337.648
                                                      
  Akaike (AIC)                               30939.408
  Bayesian (BIC)                             31074.978
  Sample-size adjusted Bayesian (SABIC)      30998.727

Root Mean Square Error of Approximation:

  RMSEA                                          0.183
  90 Percent confidence interval - lower         0.177
  90 Percent confidence interval - upper         0.190
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.110

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  MR1 =~                                              
    GDP               1.000                           
    Life_Exp          5.659    0.097   58.044    0.000
    Happiness         0.931    0.016   59.736    0.000
    Support           0.089    0.002   45.585    0.000
  MR2 =~                                              
    Positive          1.000                           
    Freedom           1.858    0.076   24.518    0.000
    Generosity        0.857    0.058   14.877    0.000
    Regional          7.995    1.138    7.026    0.000
  MR4 =~                                              
    Corruption        1.000                           
  MR3 =~                                              
    Year              1.000                           

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  MR1 ~~                                              
    MR2               0.036    0.002   15.240    0.000
    MR4              -0.078    0.005  -16.353    0.000
    MR3               0.553    0.121    4.589    0.000
  MR2 ~~                                              
    MR4              -0.007    0.000  -16.232    0.000
    MR3               0.084    0.009    9.636    0.000
  MR4 ~~                                              
    MR3              -0.086    0.020   -4.320    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .GDP               0.197    0.011   17.757    0.000
   .Life_Exp         12.638    0.506   24.994    0.000
   .Happiness         0.307    0.013   24.065    0.000
   .Support           0.006    0.000   28.956    0.000
   .Positive          0.007    0.000   26.406    0.000
   .Freedom           0.003    0.001    6.186    0.000
   .Generosity        0.023    0.001   31.520    0.000
   .Regional         10.537    0.327   32.245    0.000
   .Corruption        0.000                           
   .Year              0.000                           
    MR1               1.136    0.042   27.217    0.000
    MR2               0.005    0.000   14.435    0.000
    MR4               0.034    0.001   32.388    0.000
    MR3              24.675    0.762   32.388    0.000</code></pre>
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
x
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
npar
</td>
<td style="text-align:right;">
2.400000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
fmin
</td>
<td style="text-align:right;">
5.281489e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
chisq
</td>
<td style="text-align:right;">
2.216113e+03
</td>
</tr>
<tr>
<td style="text-align:left;">
df
</td>
<td style="text-align:right;">
3.100000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.chisq
</td>
<td style="text-align:right;">
1.072713e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.df
</td>
<td style="text-align:right;">
4.500000e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
baseline.pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
cfi
</td>
<td style="text-align:right;">
7.954423e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
tli
</td>
<td style="text-align:right;">
7.030614e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
nnfi
</td>
<td style="text-align:right;">
7.030614e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rfi
</td>
<td style="text-align:right;">
7.001121e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
nfi
</td>
<td style="text-align:right;">
7.934106e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
pnfi
</td>
<td style="text-align:right;">
5.465717e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
ifi
</td>
<td style="text-align:right;">
7.957100e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rni
</td>
<td style="text-align:right;">
7.954423e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
logl
</td>
<td style="text-align:right;">
-1.544570e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
unrestricted.logl
</td>
<td style="text-align:right;">
-1.433765e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
aic
</td>
<td style="text-align:right;">
3.093941e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
bic
</td>
<td style="text-align:right;">
3.107498e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
ntotal
</td>
<td style="text-align:right;">
2.098000e+03
</td>
</tr>
<tr>
<td style="text-align:left;">
bic2
</td>
<td style="text-align:right;">
3.099873e+04
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea
</td>
<td style="text-align:right;">
1.832962e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.ci.lower
</td>
<td style="text-align:right;">
1.768656e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.ci.upper
</td>
<td style="text-align:right;">
1.898093e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.ci.level
</td>
<td style="text-align:right;">
9.000000e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.pvalue
</td>
<td style="text-align:right;">
0.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.close.h0
</td>
<td style="text-align:right;">
5.000000e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.notclose.pvalue
</td>
<td style="text-align:right;">
1.000000e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
rmsea.notclose.h0
</td>
<td style="text-align:right;">
8.000000e-02
</td>
</tr>
<tr>
<td style="text-align:left;">
rmr
</td>
<td style="text-align:right;">
1.183338e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
rmr_nomean
</td>
<td style="text-align:right;">
1.183338e+00
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr
</td>
<td style="text-align:right;">
1.100957e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_bentler
</td>
<td style="text-align:right;">
1.100957e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_bentler_nomean
</td>
<td style="text-align:right;">
1.100957e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
crmr
</td>
<td style="text-align:right;">
1.217154e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
crmr_nomean
</td>
<td style="text-align:right;">
1.217154e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_mplus
</td>
<td style="text-align:right;">
1.100957e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
srmr_mplus_nomean
</td>
<td style="text-align:right;">
1.100957e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
cn_05
</td>
<td style="text-align:right;">
4.358775e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
cn_01
</td>
<td style="text-align:right;">
5.040973e+01
</td>
</tr>
<tr>
<td style="text-align:left;">
gfi
</td>
<td style="text-align:right;">
8.167185e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
agfi
</td>
<td style="text-align:right;">
6.748232e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
pgfi
</td>
<td style="text-align:right;">
4.603323e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
mfi
</td>
<td style="text-align:right;">
5.940683e-01
</td>
</tr>
<tr>
<td style="text-align:left;">
ecvi
</td>
<td style="text-align:right;">
1.079177e+00
</td>
</tr>
</tbody>
</table>
<table class="table table-striped" style="font-size: 12px; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
MR1
</th>
<th style="text-align:right;">
MR2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
0.4741262
</td>
<td style="text-align:right;">
0.0705956
</td>
</tr>
<tr>
<td style="text-align:left;">
omega
</td>
<td style="text-align:right;">
0.8358631
</td>
<td style="text-align:right;">
0.0570646
</td>
</tr>
<tr>
<td style="text-align:left;">
omega2
</td>
<td style="text-align:right;">
0.8358631
</td>
<td style="text-align:right;">
0.0570646
</td>
</tr>
<tr>
<td style="text-align:left;">
omega3
</td>
<td style="text-align:right;">
0.8354815
</td>
<td style="text-align:right;">
0.0556176
</td>
</tr>
<tr>
<td style="text-align:left;">
avevar
</td>
<td style="text-align:right;">
0.7454058
</td>
<td style="text-align:right;">
0.0295963
</td>
</tr>
</tbody>
</table>
<p><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-6-3.png" width="100%" style="display: block; margin: auto;" /><img src="/r-blog/2024-07-26-r-markdown/happiness_files/figure-html/unnamed-chunk-6-4.png" width="100%" style="display: block; margin: auto;" /></p>
<p>The inter-connectivity between the latent variables and the various variables used to measure hapiiness.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Helliwell, J. F., Layard, R., Sachs, J. D., De Neve, J.-E., Aknin, L. B., &amp; Wang, S. (Eds.). (2024). World Happiness Report 2024. University of Oxford: Wellbeing Research Centre.</p>
</div>
